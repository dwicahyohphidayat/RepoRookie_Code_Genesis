apiVersion: skaffold/v4beta11
kind: Config
build:
  artifacts:
    - image: aitops/${AITGITNAME}
      kaniko:
        cache: {}        
        dockerfile: Dockerfile
  cluster:
    dockerConfig:
      secretName: kaniko-registry-secret
    nodeSelector:
      type: virtual-kubelet
    tolerations:
    - key: virtual-kubelet.io/provider
      operator: Equal
      value: alibabacloud
      effect: NoSchedule    
    namespace: jenkins-agent 
  tagPolicy:
    gitCommit:
      prefix: ${AITGITBRANCH}-
deploy:
  kubectl: {}
manifests:
  rawYaml:
    - ./k8s/${AITNAMESPACE}/*
